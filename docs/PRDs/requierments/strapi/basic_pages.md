# Clarivum Strapi Requirements — Basic Pages

This document defines the authoritative Strapi (v5) requirements for Clarivum's foundational, non-interactive pages. It supersedes all template language; every item here is tailored to Clarivum's brand architecture (Skin, Fuel, Habits) and Next.js 15 frontend.

---

## 1. Scope and Objectives

- **Scope**: Pages that communicate brand, trust, compliance, and evergreen funnels: homepage, vertical hubs, legal pages, “About” cluster, contact, advertising, sitemap, and utility pages rendered statically from Strapi content.
- **Out of scope**: Interactive tools, calculators, checkout, customer account, and transactional email content. Those are modeled separately.
- **Goals**:
  - Empower editors to reorder and localize sections without engineering support using Dynamic Zones.[^dz]
  - Ensure every public-facing legal and compliance statement publishes from Strapi with Draft & Publish.[^draft]
  - Supply structured data to the Next.js frontend via documented REST/GraphQL endpoints compatible with Incremental Static Regeneration (ISR).

---

## 2. Content Architecture

### 2.1 Single Types (one instance per locale)

| Key | Purpose | Required Attributes |
| --- | --- | --- |
| `global.siteSettings` | Navigation, footer, social, CMP copy | `logoMedia`, `primaryNav[]`, `footerNav[]`, `legalLinks[]`, `socialProfiles[]`, `newsletterCapture`, `seoDefaults` |
| `global.homepage` | Clarivum landing page | Dynamic Zone `sections[]` using components in §2.3, `hero`, `seo`, `announcementBar` |
| `global.legal.<slug>` | Legal disclosures (`polityka-prywatnosci`, `polityka-cookies`, `jak-zarabiamy`, `disclaimer-medyczny`) | `title`, `summary`, `bodyRichtext`, optional `toc`, `seo` |
| `global.aboutOverview` | `/o-nas/` | `hero`, `brandStory`, DZ `sections[]` for mission, editorial, leadership |
| `global.pressRoom` | `/o-nas/dla-prasy/` | `hero`, `pressContacts[]`, `mediaAssets[]`, `brandKitLinks[]`, `seo` |
| `global.careers` | `/o-nas/kariera/` | `hero`, `openRolesEmbed`, `benefits[]`, `seo` |
| `global.advertise` | `/reklama/` | `hero`, `offerings[]`, `mediaKit`, `seo`, DZ `proof[]` |
| `global.contact` | `/kontakt/` | `intro`, `contactCards[]`, `formEmbed`, `seo` |
| `global.sitemap` | `/mapa-strony/` | `intro`, autogenerated sections toggle, `seo` |

### 2.2 Collection Types referenced by basic pages

| Collection | Purpose | Notes |
| --- | --- | --- |
| `taxonomy.subbrand` | Skin, Fuel, Habits metadata | slug, color, hero quote, CTA target |
| `content.testimonial` | Carousel & proof blocks | localized quote, role, avatar |
| `content.pressLogo` | Media kit logos | alt text mandatory |
| `content.toolTeaser` | Marketing snapshots for interactive tools | `toolSlug`, `toolRoute`, `vertical` (`skin|fuel|habits`), `toolType` (`calculator|checker|planner|quiz|timer`), `teaserHeadline`, `teaserSummary`, `valueProps[]`, `inputsDigest[]`, `resultsDigest[]`, `timeEstimateMinutes`, `difficulty` (`beginner|intermediate|advanced`), `requiresAccount`, `ctaLabel`, `ctaUrl`, `badgeLabel`, `disclaimer`, `sourceDocPath` |
| `content.calloutLink` | Reusable CTA references | label, href, UTM bundle |

> Collection types above are shared across other features (ebooks, tools). They must expose read-only views suitable for homepage sections.

### 2.3 Components (Dynamic Zone building blocks)

| Component UID | Usage | Mandatory Fields |
| --- | --- | --- |
| `home.miniDiagnostic` | Hero diagnostic CTA | `headline`, `description`, default `subbrand` relation, `ctaPrimary`, optional `ctaSecondary` |
| `home.subbrandCards` | Cards for Skin/Fuel/Habits | `title`, `subbrands[]` (relation), `ctaPerCard` |
| `home.toolsSampler` | Quick tools grid | `headline`, `toolCards[]` (each relation to `content.toolTeaser` + optional copy override), optional `layout` (`grid|carousel`) |
| `home.proof` | Testimonials and press logos | `headline`, `testimonials[]`, `pressLogos[]`, optional `metrics[]` |
| `home.ebooksHighlight` | Ebook teaser deck | `headline`, `ebookCards[]`, `ctaGlobal` |
| `home.newsletter` | Newsletter CTA | `headline`, `subheading`, `formEmbedId`, `privacyLink` |
| `shared.richtextSection` | Structured content for legal/about pages | `heading`, `bodyRichtext`, optional `cta` |
| `shared.mediaWithCopy` | Image/video + copy | `media`, `eyebrow`, `heading`, `body`, optional `cta` |
| `shared.accordionList` | FAQ / Q&A blocks | `title`, `items[] { question, answerRichtext }` |
| `shared.metricsRow` | KPI highlights | `headline`, `metrics[] { label, value, qualifier }` |
| `shared.toolCard` | Tool teaser card | relation to `content.toolTeaser`, optional `headlineOverride`, `ctaOverride`, `badgeOverride` |
| `shared.calloutBanner` | Single CTA | `style`, `copy`, `cta` |

All components must have localization enabled where textual content appears. Validation: no component saves without required fields; CTA links require HTTPS except mailto.

---

## 3. Page Specifications

### 3.1 Homepage (`global.homepage`)

- **Hero**: `home.miniDiagnostic` required as the first section. Must expose subbrand-specific CTAs aligning with current campaign priorities.
- **Sections order**: Editors may reorder; default baseline: `miniDiagnostic → subbrandCards → toolsSampler → proof → ebooksHighlight → newsletter`.
- **SEO**: localized title/description/canonical fields; Open Graph image required.
- **Population contract** (REST): frontend fetches `GET /api/homepage?populate[sections][on][home.miniDiagnostic]=*&populate[sections][on][home.subbrandCards][populate]=subbrands&populate[hero]=*&locale=pl` to comply with Strapi v5 population rules.[^populate]
- **Cache**: Next.js ISR revalidate every 600s + webhook instant purge.

### 3.2 Subbrand Hub Overview (via `taxonomy.subbrand`)

- Content surfaces: name, tagline, promise bullets, CTA pointers to `tools`, `ebooks`, `startPage`.
- Related content slots: editors select between 3–5 highlighted tools/ebooks per subbrand.
- Must expose color tokens and icon references consumed by frontend theme system.
- All subbrand documents require localized slug (`/skin`, `/fuel`, `/habits`) with translation fallback.

### 3.3 Legal Pages (`global.legal.*`)

- Each legal single type maps to a live URL listed in the footer. Draft & Publish enforced; only Legal role can publish.
- Rich text must support anchor IDs for `toc` when toggled.
- Record `lastReviewedAt` date to show freshness in the UI; editors must update this field on publish.
- Webhook requirement: publishing an entry triggers `entry.publish` webhook to notify the legal change log channel and purge relevant routes.

### 3.4 About Cluster (`global.aboutOverview`, `pressRoom`, `careers`)

- About overview dynamic zone mix: `shared.mediaWithCopy`, `shared.metricsRow`, `shared.accordionList` for editorial policy.
- Press room requires downloadable assets (relation to Upload library) categorized as `logo`, `photo`, `pdf`.
- Careers page integrates external ATS embed (iframe/script) stored in `openRolesEmbed`; sanitized to allowlist hostnames (`lever.co`, `notion.site`).

### 3.5 Advertising (`global.advertise`)

- Must present offering cards (repeatable component) each with `audience`, `deliverables`, `cta`.
- Provide optional rate-card download (Upload relation) and contact link.
- Include testimonial slider using `home.proof` component variant pinned to advertising context.

### 3.6 Contact & Sitemap

- Contact page: `contactCards[]` enumerating support channels (`press`, `partnerships`, `helpdesk`). Each card requires `title`, `description`, `channelType` (`email`, `form`, `phone`), `value`.
- Sitemap page: toggles auto-generation. If enabled, frontend fetches hierarchical navigation via `/api/sitemap?locale=<code>`; fallback to manually curated sections in DZ.

### 3.7 Tool Teasers (`content.toolTeaser`)

- Strapi stores **marketing snapshots only**; interactive logic stays in code per `docs/PRDs/requierments/tools/*.md`.
- `ctaUrl` must equal the production route for that tool (see list below); draft URLs forbidden.
- `valueProps[]`: 2–3 items, ≤45 characters each, outcome-focused (no jargon).
- `inputsDigest[]`: 1–2 bullet strings describing required user effort (e.g., “Wklej skład INCI”).
- `resultsDigest[]`: 1–2 bullet strings describing what the tool returns (e.g., “Lista alergenów + status UE”).
- `timeEstimateMinutes`: whole number rounded to nearest minute; default from spec if unset.
- `disclaimer`: localized, mirrors compliance language from the source requirement; no HTML.
- `sourceDocPath`: required; use workspace-relative path to the canonical spec for auditability.
- `badgeLabel`: optional for “Nowość”, “Beta”, or “Zaktualizowano”; editors must clear once launch settles.
- Localize all text fields; `toolSlug`, `toolRoute`, `toolType`, `vertical` remain locale-independent.

**Tool-specific copy guardrails**

- **Fragrance Allergen Checker** (`alergeny-zapachowe`, Skin, checker, route `/skin/narzedzia/alergeny-zapachowe/`)
  - Highlight dataset coverage (“26 alergenów zapachowych UE”) and oxidation warning; note `dataset_version` surfaced in UI.
  - Inputs: paste INCI; optionally toggle strict/fuzzy; mention PL/EN output.
  - Results: allergen list with EU status + advisories; disclaimer: educational, not medical, thresholds may vary.
- **BPO Fabric-Bleach Risk Aid** (`bpo-ubrania`, Skin, calculator, route `/skin/narzedzia/bpo-ubrania/`)
  - Value prop speaks to protecting fabrics from benzoyl peroxide staining; badge “Nowość” until GA.
  - Inputs: BPO %, fabric, color, dry-down, contact time; mention sliders + radios.
  - Results: score bucket (low/mod/high) + 3–4 preventive tips; disclaimer that guidance is heuristic laundry advice.
- **Routine Budget Calculator** (`budzet-rutyny`, Skin, calculator, route `/skin/narzedzia/budzet-rutyny/`)
  - Emphasize seeing monthly spend and refill cadence; note support for multiple currencies.
  - Inputs: table of products (price, size, usage); highlight shareable link export.
  - Results: per-item cost/month, months-to-empty, total monthly spend; disclaimer: assumes 30-day month baseline.
- **Actives Interaction Checker** (`interakcje-skladnikow`, Skin, checker, route `/skin/narzedzia/interakcje-skladnikow/`)
  - Promise clear “hard avoid / caution / ok” verdicts grounded in rule set.
  - Inputs: INCI list + optional context flags (e.g., pregnancy); mention ingredient tagging.
  - Results: prioritized interaction list with actionable guidance; disclaimer: informational, not a substitute for medical advice.
- **Sunscreen Amount Calculator** (`kalkulator-dawki-spf`, Skin, calculator, route `/skin/narzedzia/kalkulator-dawki-spf/`)
  - Value: “Ile ml/pomp potrzebujesz przy 2 mg/cm²” with adult baseline call-out.
  - Inputs: select body zones, optional packaging data; highlight fast toggles.
  - Results: ml/g totals plus pump/drop conversions; disclaimer: heuristic for adults, consult pediatric guidance separately.
- **Comedogenicity Helper** (`komedogennosc-pomocnik`, Skin, checker, route `/skin/narzedzia/komedogennosc-pomocnik/`)
  - Emphasize quick risk signal based on classic comedogenic scale; note variability between users.
  - Inputs: paste INCI; optional batch/key not exposed in teaser.
  - Results: score (0–5) with bucket + context note; disclaimer about concentration/formulation dependence.
- **pH Compatibility Estimator** (`ph-kompatybilnosc`, Skin, estimator, route `/skin/narzedzia/ph-kompatybilnosc/`)
  - Pitch sequencing clarity (“Oceń kolejność i różnice pH”).
  - Inputs: ordered routine with optional known pH + actives tags.
  - Results: estimated pH per step, delta warnings, suggested order; disclaimer: heuristic estimation, no laboratory measurement.
- **Pilling Risk Estimator** (`pilling-check`, Skin, checker, route `/skin/narzedzia/pilling-check/`)
  - Promise actionable mitigation tips for high-risk routines.
  - Inputs: INCI per step + layering behaviour toggles.
  - Results: risk bucket + top contributors; disclaimer: actual performance varies with application technique.
- **Exfoliation Planner** (`planer-eksfoliacji`, Skin, planner, route `/skin/narzedzia/planer-eksfoliacji/`)
  - Value: personalized weekly cadence aligned with skin type, concerns, sensitivity.
  - Inputs: skin type, concerns, current actives, preferred exfoliant, sensitivity level.
  - Results: sessions/week, sample schedule, rules applied; disclaimer: not medical advice, reduce frequency if irritation occurs.
- **Fitzpatrick Skin Type Quiz** (`test-fitzpatrick`, Skin, quiz, route `/skin/narzedzia/test-fitzpatrick/`)
  - Position as evidence-based 10-question quiz to find phototype I–VI.
  - Inputs: multi-question self-assessment; highlight accessibility (voiceover-friendly).
  - Results: score + phototype with sun behavior guidance; disclaimer: educational, does not replace professional assessment.
- **SPF Reapplication Timer** (`timer-reaplikacji`, Skin, timer, route `/skin/narzedzia/timer-reaplikacji/`)
  - Emphasize proactive reminders based on exposure context (water, outdoors).
  - Inputs: last application time, water resistance, exposure toggles; mention timezone awareness.
  - Results: exact reapply timestamp, minutes remaining, rule used; disclaimer: follow label instructions and adjust for conditions.

---

## 4. Editorial Workflow & Roles

- **Roles**:
  - *Editor*: manage homepage, about, advertising content.
  - *Legal*: exclusive publish rights for legal single types.
  - *Comms*: manage press assets and contact details.
- **Draft & Publish**: Enabled for every single type/collection in scope.[^draft]
- **Locales**: `pl` default, `en` optional. Editors must complete localized versions before publish; Strapi's locale switcher applies per entry.[^i18n]
- **Preview**: Frontend exposes `/api/preview?documentId=…&locale=…` endpoint requiring signed URL token stored in environment variable. Strapi preview button configuration must use this endpoint.
- **Release Management**: Utilize Strapi Releases (Enterprise) for coordinated pushes across homepage + legal updates; publish event triggers `releases.publish` webhook when batching is used.[^releases]

---

## 5. API & Integration Requirements

- **REST baseline**: Use read-only API token scoped to the endpoints above. All requests must specify `locale` and explicit `populate` fragments for dynamic zones (Strapi v5 requirement).[^populatev5]
- **GraphQL optional**: If GraphQL plugin is enabled, frontend may query using fragments per component type to reduce over-fetch (`... on HomeMiniDiagnostic`).[^graphql]
- **Documents API**: Use `/documents` endpoints for ISR builds to pull definitive published content; `status=published` filter mandatory for public rendering.[^docapi]
- **Webhooks**: Configure at minimum:
  - `entry.publish` & `entry.unpublish` → Next.js `/api/revalidate` with payload of affected `paths`.
  - `releases.publish` → Slack notification + revalidation.
- **Caching**: Strapi responses cached at edge (Vercel) for 5 min; revalidation path purges specific routes rather than global.

---

## 6. Security & Compliance

- Public token restricted to GET requests; IP allowlist on admin panel; enforce MFA/SSO for admins.
- Enable field-level permissions so tokens only reveal attributes described here.
- Enforce HTTPS and sanitize embeds (allowlist hosts for iframes and scripts).
- Store legal `version` numbers and `changeSummary` to support compliance audits.
- Media uploads stored in S3-compatible bucket with CDN; each asset must have alt text for accessibility.

---

## 7. Non-Functional Requirements

- **Performance**: Content payload per page must remain under 250 KB compressed; prefer structured components instead of large WYSIWYG blobs.
- **Localization readiness**: All textual fields flagged for translation; dynamic zone reorder per locale supported.[^i18n]
- **Accessibility**: Provide descriptive alt text, heading hierarchy (H1 only once per page), and link purpose clarity.
- **Observability**: Instrument webhook failures; retry with exponential backoff.
- **Backup**: Nightly Strapi database snapshot + object storage versioning for uploads.

---

## 8. Implementation Checklist

- [ ] All single types created with Draft & Publish + i18n enabled.
- [ ] Components validated (required fields, localization toggled).
- [ ] Webhooks configured and tested against Next.js revalidate endpoint.
- [ ] Role-based permissions mapped and tested for Editor, Legal, Comms.
- [ ] Frontend fetch utilities updated to use explicit Strapi v5 populate fragments.
- [ ] Playbook for editors documented in `docs/role-guides/editorial.md`.

---

## 9. Open Questions

1. Do we require Enterprise Review Workflows for legal approvals beyond Draft & Publish?
2. Should advertising testimonials reuse global pool or maintain a dedicated collection for sponsorship compliance?
3. Confirm whether sitemap auto-generation lives in Strapi plugin or Next.js build step.

---

[^dz]: Strapi Dynamic Zones allow editors to assemble pages from reusable components. See Strapi docs on [configuring dynamic zones](https://docs.strapi.io/dev-docs/content-type-builder/configuring-fields-content-type).
[^draft]: Draft & Publish must be enabled per single type in Strapi's Content-Type Builder advanced settings. Reference: [Strapi Draft & Publish](https://docs.strapi.io/dev-docs/content-type-builder/managing-content-types#advanced-settings).
[^populate]: Population example aligns with Strapi v5's requirement for explicit populate fragments. See [Understanding populate](https://docs.strapi.io/dev-docs/api/rest/populate).
[^populatev5]: Strapi v5 deprecates shared populate strategies; details in [v4 to v5 migration notes](https://docs.strapi.io/dev-docs/migration/v4-to-v5/breaking-changes/no-shared-population-strategy-components-dynamic-zones).
[^graphql]: GraphQL dynamic zone usage documented at [Strapi GraphQL API](https://docs.strapi.io/dev-docs/api/graphql).
[^docapi]: Documents API enables fetching published entries by documentId; see [Document Service](https://docs.strapi.io/dev-docs/api/document-service).
[^i18n]: Internationalization workflows detailed in [Strapi translating content guide](https://docs.strapi.io/user-docs/content-manager/translating-content).
[^releases]: Releases webhook payload documented at [Strapi webhooks](https://docs.strapi.io/dev-docs/backend-customization/webhooks).
